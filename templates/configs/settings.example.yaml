# ═══════════════════════════════════════════════════════════════════════════════
# MicroBot 配置文件
# ═══════════════════════════════════════════════════════════════════════════════
# 复制此文件到 ~/.microbot/settings.yaml 并修改
#
# 环境变量：支持 ${VAR_NAME} 语法
# 配置优先级：目录级 > 项目级 > 用户级
#
# 文档：https://microbot.dev/config
# ═══════════════════════════════════════════════════════════════════════════════

# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ Agent 配置（必填）                                                          ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
agents:
  # ─────────────────────────────────────────────────────────────────────────
  # 工作区路径【必填】
  # 存储会话、记忆、缓存、定时任务等数据
  # ─────────────────────────────────────────────────────────────────────────
  workspace: ~/.microbot/workspace

  # ─────────────────────────────────────────────────────────────────────────
  # 模型配置【必填】
  # 格式：<provider>/<model>，provider 需在下方 providers 中定义
  #
  # ┌─────────────────────────────────────────────────────────────────────────┐
  # │ 字段  │ 说明                                         │ 是否必填         │
  # ├─────────────────────────────────────────────────────────────────────────┤
  # │ chat  │ 对话模型，处理用户消息                       │ 必填             │
  # │ check │ 意图识别模型，用于自动路由判断任务复杂度     │ 可选，默认用 chat│
  # └─────────────────────────────────────────────────────────────────────────┘
  # ─────────────────────────────────────────────────────────────────────────
  models:
    chat: ollama/qwen3
    # check: ollama/qwen3

  # ─────────────────────────────────────────────────────────────────────────
  # 生成参数【可选，有默认值】
  # ─────────────────────────────────────────────────────────────────────────
  # maxTokens: 8192           # 最大生成长度
  # temperature: 0.7          # 温度 0-2，越低越确定，越高越随机
  # topK: 50                  # Top-K 采样，限制候选 token 数量
  # topP: 0.7                 # Top-P 核采样，累积概率阈值
  # frequencyPenalty: 0.5     # 频率惩罚 0-2，降低重复内容
  # maxToolIterations: 20     # 工具调用最大迭代次数

  # ─────────────────────────────────────────────────────────────────────────
  # 自动路由【可选】
  # 根据任务复杂度自动选择合适级别的模型
  # 需要在 routing.rules 中配置规则
  # ─────────────────────────────────────────────────────────────────────────
  # auto: true                # 启用自动路由
  # max: false                # 性能优先模式（始终选最强模型）

# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ Provider 配置【必填，至少配置一个】                                         ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
# 模型级别：fast < low < medium < high < ultra
# 模型能力：vision(图片理解) | think(深度推理) | tool(工具调用)
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ 字段              │ 说明                                   │ 是否必填       │
# ├─────────────────────────────────────────────────────────────────────────────┤
# │ baseUrl           │ API 地址                               │ 必填           │
# │ apiKey            │ API 密钥，支持环境变量 ${VAR_NAME}      │ 部分 Provider │
# │ models            │ 模型列表                               │ 必填           │
# │ models[].id       │ 模型 ID                                │ 必填           │
# │ models[].level    │ 性能级别，用于自动路由                  │ 可选，默认 medium │
# │ models[].vision   │ 是否支持图片输入                        │ 可选，默认 false │
# │ models[].think    │ 是否支持深度推理（如 DeepSeek-R1）       │ 可选，默认 false │
# │ models[].tool     │ 是否支持工具调用                        │ 可选，默认 true │
# └─────────────────────────────────────────────────────────────────────────────┘
providers:
  # ═════════════════════════════════════════════════════════════════════════
  # 本地模型：Ollama
  # 安装：https://ollama.ai
  # 特点：无需 apiKey，本地运行，隐私安全
  # ═════════════════════════════════════════════════════════════════════════
  # ollama:
  #   baseUrl: http://localhost:11434/v1
  #   models:
  #     # Qwen3（8B）：轻量通用模型，支持工具调用
  #     - id: qwen3
  #       level: fast
  #       tool: true
  #     # Qwen3-VL：视觉语言模型，支持图片理解 + 工具调用
  #     - id: qwen3-vl
  #       vision: true
  #       level: low
  #       tool: true
  #     # DeepSeek-R1（8B）：轻量推理模型，擅长逻辑推理
  #     - id: deepseek-r1
  #       level: low
  #       think: true
  #       tool: false

  # ═════════════════════════════════════════════════════════════════════════
  # 在线 API：智谱 GLM（bigmodel.cn）
  # 文档：https://open.bigmodel.cn/dev/api
  # 特点：国产领先，支持超长上下文、视觉、工具调用
  # ═════════════════════════════════════════════════════════════════════════
  # glm:
  #   baseUrl: https://open.bigmodel.cn/api/paas/v4
  #   apiKey: ${GLM_API_KEY}
  #   models:
  #     # GLM-5：最新旗舰模型，编程能力对齐 Claude Opus 4.5
  #     - id: glm-5
  #       level: ultra
  #       tool: true
  #     # GLM-4.7：高智能模型，通用对话与智能体能力
  #     - id: glm-4.7
  #       level: high
  #       tool: true
  #     # GLM-4.6V：旗舰视觉推理模型，原生支持工具调用
  #     - id: glm-4.6v
  #       vision: true
  #       level: high
  #       tool: true

  # ═════════════════════════════════════════════════════════════════════════
  # 在线 API：MiniMax（海螺 AI）
  # 文档：https://platform.minimax.io/docs
  # 特点：专为 Agent 任务优化，工具调用能力领先
  # ═════════════════════════════════════════════════════════════════════════
  # minimax:
  #   baseUrl: https://api.minimax.chat/v1
  #   apiKey: ${MINIMAX_API_KEY}
  #   models:
  #     # MiniMax-M2.1：Agent 优化模型，擅长多步骤任务
  #     - id: minimax-m2.1
  #       level: high
  #       tool: true
  #     # MiniMax-M2.5：最新模型，SWE-Bench 80.2%，工具调用领先
  #     - id: minimax-m2.5
  #       level: ultra
  #       tool: true

  # ═════════════════════════════════════════════════════════════════════════
  # 在线 API：Moonshot Kimi
  # 文档：https://platform.moonshot.cn/docs
  # 特点：视觉 Agent 模型，支持多步工具调用
  # ═════════════════════════════════════════════════════════════════════════
  # kimi:
  #   baseUrl: https://api.moonshot.cn/v1
  #   apiKey: ${MOONSHOT_API_KEY}
  #   models:
  #     # Kimi-K2.5：视觉 Agent 模型，支持代码生成 + 图片理解 + 工具调用
  #     - id: kimi-k2.5
  #       vision: true
  #       level: ultra
  #       tool: true

  # ═════════════════════════════════════════════════════════════════════════
  # 在线 API：DeepSeek
  # 文档：https://platform.deepseek.com/docs
  # 特点：高性价比，支持深度推理
  # ═════════════════════════════════════════════════════════════════════════
  # deepseek:
  #   baseUrl: https://api.deepseek.com/v1
  #   apiKey: ${DEEPSEEK_API_KEY}
  #   models:
  #     - id: deepseek-chat
  #       level: medium
  #       tool: true
  #     - id: deepseek-reasoner
  #       level: high
  #       think: true

  # ═════════════════════════════════════════════════════════════════════════
  # 在线 API：OpenAI 兼容接口
  # 可接入任何 OpenAI 兼容的 API 服务
  # ═════════════════════════════════════════════════════════════════════════
  # openai:
  #   baseUrl: https://api.openai.com/v1
  #   apiKey: ${OPENAI_API_KEY}
  #   models:
  #     - id: gpt-4o-mini
  #       level: fast
  #     - id: gpt-4o
  #       level: high
  #       vision: true
  #       tool: true

# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ Channel 配置【可选】                                                        ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
# 消息通道，将 Agent 接入外部平台（飞书、钉钉、企业微信等）
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ 字段        │ 说明                               │ 是否必填               │
# ├─────────────────────────────────────────────────────────────────────────────┤
# │ enabled     │ 是否启用                           │ 可选，默认 false       │
# │ appId       │ 应用 ID                            │ 启用时必填             │
# │ appSecret   │ 应用密钥                           │ 启用时必填             │
# │ allowFrom   │ 消息来源白名单，空=接收所有          │ 可选                   │
# └─────────────────────────────────────────────────────────────────────────────┘
channels:
  # ─────────────────────────────────────────────────────────────────────────
  # 飞书机器人
  # 文档：https://microbot.dev/extensions/channels#飞书
  # ─────────────────────────────────────────────────────────────────────────
  # feishu:
  #   enabled: true
  #   appId: cli_xxxx
  #   appSecret: xxxx
  #   allowFrom: []              # 白名单，空=接收所有
  #   # allowFrom:
  #   #   - ou_xxxx              # open_id
  #   #   - user@example.com     # email

# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ Routing 配置【可选】                                                        ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
# 智能路由：根据关键词、消息长度自动选择合适级别的模型
# 需开启 agents.auto: true
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ 字段             │ 说明                                   │ 是否必填         │
# ├─────────────────────────────────────────────────────────────────────────────┤
# │ enabled          │ 是否启用路由                           │ 可选，默认 true  │
# │ rules            │ 路由规则列表                           │ 可选             │
# │ rules[].keywords │ 匹配关键词（任一匹配即生效）            │ 可选             │
# │ rules[].minLength│ 最小消息长度（字符数）                  │ 可选             │
# │ rules[].maxLength│ 最大消息长度（字符数）                  │ 可选             │
# │ rules[].level    │ 目标性能级别                           │ 必填             │
# │ rules[].priority │ 规则优先级（越大越优先）                │ 可选，默认 0     │
# └─────────────────────────────────────────────────────────────────────────────┘
routing:
  enabled: true
  rules:
    # 架构级任务 → 最强模型
    - keywords: [架构, 重构, 设计模式, architecture, refactor]
      level: ultra
      priority: 10
    # 复杂开发任务 → 高性能模型
    - keywords: [调试, 修复, bug, error, debug, fix]
      level: high
      priority: 7
    - keywords: [实现, 开发, 创建, implement, develop, create]
      level: high
      priority: 6
    # 中等任务 → 中等模型
    - keywords: [解释, 说明, 修改, explain, modify]
      level: medium
      priority: 5
    # 简单任务 → 快速模型
    - keywords: [翻译, 格式化, 总结, translate, format, summarize]
      level: low
      priority: 3
    # 问候语 → 最快模型
    - keywords: [你好, hello, hi, 谢谢, thanks, 再见, bye]
      level: fast
      priority: 2

# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ Workspaces 配置【可选】                                                     ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
# 工作区列表：限制 Agent 只能访问指定目录，实现隔离
# 未配置时，Agent 只能访问 agents.workspace 目录
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ 格式      │ 说明                                             │ 是否必填       │
# ├─────────────────────────────────────────────────────────────────────────────┤
# │ 简写形式  │ 仅路径，如 ~/projects/my-project                 │ -              │
# │ 完整形式  │ path + name + description                        │ path 必填      │
# └─────────────────────────────────────────────────────────────────────────────┘
# workspaces:
#   # 简写形式
#   - ~/projects/my-project
#   # 完整形式
#   - path: ~/Documents
#     name: 文档
#     description: 个人文档目录